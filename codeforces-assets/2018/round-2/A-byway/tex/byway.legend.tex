\begin{center}\small{
    See the original problem statement from BIO 2018 Round 2 at
    \url{https://www.olympiad.org.uk/papers/2018/final/Byway.pdf}
  }\end{center}

  Change is coming to that sleepy knot of villages known as The Endians. Long
  established businesses are selling off long forgotten warehouses. You can hardly
  move without being stopped to help with a short survey. The local byways are
  struggling to keep up with the demand.

  Each byway connects two villages and takes a fixed amount of time to travel
  along (in either direction). It is possible to travel between any two villages, either
  by a direct byway or along a sequence of byways. A recent petition by local
  businesses --- Better Byway Bylaw (B) --- has been successful and one of the
  byways will be upgraded, halving the time required to travel along it.

  For example, suppose that the following byways (1---2, 2---3, 3---4) exist and take
  10 to travel, and that a byway 1---4 exists and takes 40 to travel:

  \begin{itemize}
    \item The fastest journey from 1 to 4 is the route 1---2---3---4 which takes 30;
    \item Upgrading one of the byways on this route will reduce the time to 25;
    \item Alternatively, upgrading the 1---4 byway gives a journey from 1 to 4 (along this byway) with a time of 20.
  \end{itemize}
